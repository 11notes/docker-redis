#!/bin/ash
  if [ -z "${1}" ]; then
    if [ ! -f "${APP_ROOT}/ssl/ca.key" ]; then
      echo "Creating new certificate for ${1} signed by CA"
      openssl req -x509 -newkey rsa:4096 -subj "/C=XX/ST=XX/L=XX/O=XX/OU=XX/CN=${1}" \
        -CA "${APP_ROOT}/ssl/ca.crt" \
        -CAkey "${APP_ROOT}/ssl/ca.key" \
        -keyout "${APP_ROOT}/ssl/${1}.key" \
        -out "${APP_ROOT}/ssl/${1}.crt" \
        -days 3650 -nodes -sha256 &> /dev/null
    else
      echo "No CA.key present to sign client certificate"
    fi
  else
    echo "CN needed to create client certificate"
  fi